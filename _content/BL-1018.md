---
Id: 1018
Title: Amazon VPC
Author: Steve
Tags: AWS
Topic: Networking in AWS
Abstract: In the world of cloud computing, managing network resources efficiently is crucial for ensuring high availability, scalability, and reliability. One such resource in Amazon Web Services (AWS) is the Elastic IP address. Elastic IPs play a vital role in managing public IP addresses for your AWS resources, such as EC2 instances, NAT gateways, and more. This article will provide an in-depth exploration of AWS Elastic IPs, including their features, use cases, benefits, and step-by-step examples.
HeaderImage: /BL-1018/vpc.png
isPublished: true
---

## Create Subnets and Allocate IP addresses in an Amazon Virtual Private Cloud (Amazon VPC)

### Objectives
In this article, you will:

* Summarize the customer scenario
* Create a Amazon Virtual Private Cloud (Amazon VPC) and understand how to create subnets and allocate IP addresses
* Familiarize yourself with the Amazon Web Services (AWS) Management Console
* Develop a solution to the customer's issue in this lab
* Summarize and describe your findings (group activity)


Ticket from your customer
Hello, Cloud Support!

I'm new to AWS, and I need help setting up a VPC. Can you please help me through the setup process? I would like to build only the VPC part and would like to make it look something like the following picture. Can you help me ensure  I have around 15,000 private IP addresses in this VPC available?  I would also like the VPC IPv4 CIDR block to be a 192.x.x.x. I don't remember which is a private range though. Can you confirm that? I would also like to allocate at least 50 IP addresses for the public subnet.

Thanks!
Paulo Santos
Startup Owner

## Customer Diagram

![vpc-diagram](/BL-1018/vpc.png)


## What is a VPC (Virtual Private Cloud)
A VPC is like a data center but in the cloud. It is logically isolated from other virtual networks, and you can use a VPC to spin up and launch your AWS resources within minutes.
Resources within a VPC communicate with each other through private IP addresses. An instance needs a public IP address for it to communicate outside the VPC. The VPC needs networking resources, such as an internet gateway and a route table, for the instance to reach the internet.
A CIDR block is a range of private IP addresses that is used within the VPC (for example, the /16 number that you see next to an IP address).
A subnet is a range of IP addresses within your VPC.

## Step by step into launching and configuring VPC

### Step One Launching a VPC

* **Define the VPC**: Specify the IP address range (CIDR block).
* **Create Subnets**: Divide the VPC into public and private subnets.
* **Configure Route Tables**: Define routes for traffic between subnets and to the internet.
* **Attach an Internet Gateway**: Enable internet access for public subnets.
* **Set Up NAT Gateway**: Allow private subnets to access the internet.
* **Launch Resources**: Deploy EC2 instances, RDS databases, etc., in the appropriate subnets.
* **Configure Security**: Use Security Groups and NACLs to control traffic.

### Define the VPC
 1. In the AWS console, type and search for VPC in the search bar on the top-left corner. Select VPC from the list. Alternatively, You can also find VPC under Services - Networking & Content Delivery in the top left corner

![vpc-search](/BL-1018/vpc_search.png)


You are now in the Amazon VPC dashboard. You use the Amazon Virtual Private Cloud (Amazon VPC) service to build your VPC.

2. Choose the Create VPC button to launch your first VPC. This will launch you into a step by step process to set up a VPC with it's basic components.

![create-vpc](/BL-1018/create-vpc.png)

You can configure the following in order to lauch your VPC
Configure the following options:

* VPC name - This is the name of the VPC

* IPv6 CIDR block - Select an IPv4 Block(e.g 10.10.10/16). For the customer scenarion above, 15000 addresses are needed so a /18 is used. (192.168.0.0/18)

Recall that the CIDR block defines the size of the VPC in terms of the number of addresses that the VPC offers to devices.

* Enable DNS hostnames and DNS resolutions if using public resources

![create-vpc](/BL-1018/create-vpc2.png)

![create-vpc](/BL-1018/create-vpc3.png)
* Click **Create VPC**

### Create Subnets (Public & Private)

* In the VPC Dashboard, click **Subnets** → **Create Subnet**.

![create-vpc](/BL-1018/subnets.png)

![create-vpc](/BL-1018/create-subnet.png)

* Choose your VPC

* Create a Public Subnet by stating the name, CIDR block of the subnet, Availability Zone, Configure Auto-assign Public IP as enable or disable and then click **Create**.

* Create a Private Subnet by stating the name, CIDR block of the subnet, Availability Zone, and disble Auto-assign Public IP and then click **Create**.

![create-vpc](/BL-1018/public-subnet.png)

You can delete or edit the settings of a particular subnet by selecting the subnet in your dashboard then clicking on **Actions** and then select whether you want to delete or edit settings or manage the subnet.

![edit-subnet](/BL-1018/edit-subnet1.png)

![edit-subnet](/BL-1018/edit-subnet2.png)


## The Key Components of a VPC {#The-Key-Components-of-a-VPC}

### 1. IP Address range (CIDR Block)

A VPC is defined using a range of IP addresses.

Unlike the traditional Classful IP addressing, which had limitations and wastage of IP addresses, the Classless Inter-Domain Routing makes it flexible to manage networks and IP addressing without limitations and wastage.

The CIDR determines the size of the VPC in terms of the number of IP addresses available in it.

### 2. Subnets

This is a portion or segment of the VPC CIDR Block (IP address range) that one can place resources.

A subnet is tied to a specific Availability Zone (AZ) within a region.
There are two types of subnets in a VPC:

* Public Subnet - The resources in this subnet can access the internet using an internet gateway.(IGW)


* Private Subnet - Resources in this subnet cannot directly access the internet. They can only do so via a NAT gateway or a NAT instance.

### 3. Route Tables

In a house, we have rooms and for one to move from one room to another, he/she needs to follow certain paths or corridors in that house.

In a network, for a traffic to travel from one from a particular network to another, in order to reach the intended device, it needs to follow some paths.

Routers are used to route (to provide the best paths) packets or traffic from one network to another.

A route table contains a set og rules (routes) that determine where network traffic is directed.

Each subnet must be associated with a route table.

A default route is created automatically when the VPC is created. A default route is a route to destinations not found within the network.

### 4. Internet Gateway(IGW)
Resources within the public or private networks of a VPC may want an internet access.

In order to communicate with the internet, a gateway (like a door) is required.

An internet gateway allows communication between resources in your public subnet of your VPC and the internet.

### 5. NAT Gateway or NAT instance
This gateway allowsresources within the private subnet to access the internet for updates or patches while preventing the internet from initiating connection to those Resources

NAT Gateway is a managed service while a NAT instance is an EC2 instance configured to perform NAT.

### 6. Security Groups
Just like a traditional firewall that filters inbound and outbound traffic, a security group acts as a virtual firewall for instances in the VPC, to control inbound and outbound traffic.

They operate at instance level and are stateful (automatically allows return trffic).

Stateful means that they keep records of states or operations at the network interfaces. i.e. Memorize

### 7. Network Access Control Lists (NACLs)
These are stateless(you must explicitly allow return traffic) firewall that operates at subnet level.

They deny or allow traffic based on defined rules.

### 7. VPC Peering
VPC Peering allows you to connect two VPCs privately using AWS’s network.

The VPCs can be in the same or different AWS accounts or regions.

Peered VPCs can communicate as if they are part of the same network.

### 8. VPC Endpoints
VPC Endpoints allow private connectivity between your VPC and supported AWS services (e.g., S3, DynamoDB) without using the internet or a NAT device.

There are two types:

* Interface Endpoints: Uses an Elastic Network Interface (ENI) with a private IP address.

* Gateway Endpoints: Uses a gateway for specific services like S3 and DynamoDB.

### 9. Elastic IP Addresses
An Elastic IP (EIP) is a static, public IPv4 address that you can allocate to your AWS account and associate with instances or NAT Gateways.



## Conclusion
In summary, a VPC is a foundational component of AWS that provides a secure, scalable, and customizable networking environment for your cloud resources. It is essential for building secure and efficient cloud architectures.
